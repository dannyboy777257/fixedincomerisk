---
title: "Shiny IR App"
format: html
editor: visual
---

```{r libraries}
library(tidyverse)
library(ggplot2)
library(tidyquant)
library(tidyr)
library(RTL)
library(shiny)
library(lubridate)

```

```{r Data Table}
symbols <- c("DGS1MO", "DGS3MO", "DGS6MO", "DGS1", "DGS2", "DGS3", "DGS5", "DGS7", "DGS10", "DGS20", "DGS30")

df <- tidyquant::tq_get(symbols, get = "economic.data", from = "1992-01-01", to = Sys.Date()) %>%
  tidyr::drop_na() %>% 
  dplyr::mutate(maturity_in_years = dplyr::case_when(
    symbol == "DGS1MO" ~ round(1/12, 3),
    symbol == "DGS3MO" ~ round(3/12, 3),
    symbol == "DGS6MO" ~ 6/12,
    symbol == "DGS1"   ~ 1,
    symbol == "DGS2"   ~ 2,
    symbol == "DGS3"   ~ 3,
    symbol == "DGS5"   ~ 5,
    symbol == "DGS7"   ~ 7,
    symbol == "DGS10"  ~ 10,
    symbol == "DGS20"  ~ 20,
    symbol == "DGS30"  ~ 30
  )) %>%
  dplyr::rename(rate = price) %>%
  dplyr::mutate(rate = rate / 100,
                changeBasisPoints = round(((rate - lag(rate, 1)) * 10000), digits = 5),
                par = 100) %>% 
dplyr::group_by(symbol) %>% 
  dplyr::arrange(desc(date),.by_group = TRUE) %>%  
  dplyr::mutate(stdev = slider::slide_dbl(
                    .x = changeBasisPoints,
                    .f = sd, 
                    .before = 1, 
                    .after = 0, 
                    .complete = FALSE)) %>% 
  dplyr::filter(maturity_in_years ==2) %>% 
  dplyr::arrange((date))
df

```
